# Backend Build Tracker (Demo, No Auth)

**Purpose**: Track the backend build phases toward the original AI trading flow goal.  
**Scope**: Backend only, demo mode (auth excluded).

---

## Phase 0 — Baseline Wiring

**Status**: ✅ Complete

- [x] Define execution step schema and enforce consistent step updates
  - Added `StepName` enum: `data_fetch`, `market_analysis`, `risk_validation`, `decision`
  - Added `create_standard_steps()` factory
  - Fixed `execute_flow` to use correct step indices
- [x] Wire scheduled flow triggers (cron/beat → `/flows/{id}/trigger`)
  - Created `app/tasks/flow_tasks.py`
  - Added `trigger_scheduled_flows_task` to celery beat (every minute)
  - Uses `croniter` to evaluate flow schedules
- [x] Add execution status transitions (pending → running → completed/failed)
  - Each step now has proper start/complete timestamps
  - Failed steps are marked with error message

---

## Phase 1 — Market + Signal Sources (Pre-Trade Gate)

**Status**: ✅ Complete

- [x] Market data service (OHLCV + realtime price) — existing Binance client
- [x] X/Twitter search integration (BTC terms → sentiment)
  - Created `app/integrations/sentiment/twitter_client.py`
  - Uses Twitter API v2 for recent tweet search
  - Keyword-based sentiment analysis
- [x] Reddit search integration (BTC subreddits → sentiment)
  - Created `app/integrations/sentiment/reddit_client.py`
  - Searches crypto subreddits (Bitcoin, CryptoCurrency, etc.)
  - OAuth2 authentication
- [x] Polymarket odds integration (BTC markets → signal)
  - Created `app/integrations/sentiment/polymarket_client.py`
  - Public API, no key required
  - Analyzes price prediction market odds
- [x] Signal aggregator → normalized `signal_score`
  - Created `app/services/signal_aggregator.py`
  - Combines all sources with weighted average
  - Outputs `AggregatedSignal` with score, confidence, classification

---

## Phase 2 — AI Pre-Trade Flow

**Status**: ⏳ Not started

- [ ] Pre-trade evaluator agent (market + sentiment + indicators)
- [ ] Entry gate (only execute if signal + risk pass)
- [ ] Decision logging (model, tokens, cost, reasoning)

---

## Phase 3 — Risk Rules Engine

**Status**: ⏳ Not started

- [ ] Risk rules schema + persistence
- [ ] Validate proposed trade against limits
- [ ] Wire risk manager input to real limits + portfolio state

---

## Phase 4 — Exchange Execution

**Status**: ⏳ Not started

- [ ] Decrypt credentials and build exchange client
- [ ] Place order on exchange
- [ ] Cancel order on exchange
- [ ] Retry + failure handling

---

## Phase 5 — Position Lifecycle Automation

**Status**: ⏳ Not started

- [ ] Create position on fill
- [ ] Monitoring loop (worker) + price refresh
- [ ] Exit conditions (SL/TP/AI signal/margin)
- [ ] Forced close path

---

## Phase 6 — Transactions + Wallet State

**Status**: ⏳ Not started

- [ ] Transaction ledger (entry/exit)
- [ ] Wallet state updates (PnL, exposure, utilization)
- [ ] Execution → position → transaction traceability

---

## Phase 7 — Safeguards + Ops

**Status**: ⏳ Not started

- [ ] Circuit breakers / kill switch
- [ ] Rate limiting + error middleware
- [ ] Metrics + structured logs for executions

---

## Required Credentials

Add these to your `.env` file:

### Core (Required)
```env
# MongoDB
MONGODB_URL=mongodb://localhost:27017
MONGODB_DB_NAME=moniqo_demo

# Redis (also used for Celery)
REDIS_URL=redis://localhost:6379/0

# JWT (generate a random key)
JWT_SECRET_KEY=your-secret-key

# Encryption (generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())")
ENCRYPTION_KEY=your-fernet-key
```

### AI Models (at least one required for flows)
```env
# Groq (free tier available)
GROQ_API_KEY=gsk_...

# OR Google Gemini
GEMINI_API_KEY=...

# OR OpenRouter
OPENROUTER_API_KEY=...
```

### Sentiment Sources (optional, for signal aggregation)
```env
# X/Twitter API (requires developer account)
TWITTER_BEARER_TOKEN=AAAA...

# Reddit API (create app at reddit.com/prefs/apps)
REDDIT_CLIENT_ID=...
REDDIT_CLIENT_SECRET=...

# Polymarket: No API key needed (public API)
```

### AWS S3 (for avatar uploads, can be dummy for demo)
```env
AWS_ACCESS_KEY_ID=...
AWS_SECRET_ACCESS_KEY=...
AWS_S3_BUCKET_NAME=...
```

### Email (can be dummy for demo)
```env
RESEND_API_KEY=...
FROM_EMAIL=noreply@example.com
SUPERADMIN_EMAIL=admin@example.com
SUPERADMIN_PASSWORD=admin123
```

